machine:
  timezone: Europe/London
  python:
    version: 2.6.9
  pre:
    - sudo apt-get -y install rpm  libsasl2-dev libldap2-dev libssl-dev
    - sudo mkdir -p /opt/cantemo/python/lib/python2.6/site-packages
    - sudo chown ubuntu /opt/cantemo/python/lib/python2.6/site-packages

dependencies:
  cache_directories:
    - "/opt/circleci/.pyenv/versions/2.6.9"
    - "/home/ubuntu/virtualenvs/venv-2.6.9"
  pre:
    - pip install boto  #only required for build/upload to s3

deployment:
  maindeploy:
    branch: /.*/
    commands:
      - chmod a+x setup.py
      - ./setup.py sdist
      - ./setup.py awsupload --bucket ${UPLOAD_BUCKET} --path gnmvidispine --region eu-west-1  --acl public-read